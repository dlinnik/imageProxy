# Сервис Image Proxy

Прокси-сервис на TypeScript, который обрабатывает загрузку изображений из различных облачных хранилищ, включая Google Drive и Яндекс.Диск. Сервис предоставляет единый интерфейс для получения изображений с учетом особенностей каждого провайдера.

## Возможности

- Поддержка нескольких облачных хранилищ:
  - Google Drive
  - Яндекс.Диск (включая общие папки)
  - Прямые URL
- Автоматическая обработка и перенаправление URL
- Поддержка CORS
- Стриминговая отдача изображений для эффективного использования памяти

## Необходимые компоненты

- Node.js (14.x или выше)
- npm
- Docker (опционально, для контейнеризации)

## Установка

1. Клонируйте репозиторий
2. Установите зависимости:
   ```bash
   npm install
   ```
3. Соберите TypeScript-код:
   ```bash
   npm run build
   ```

## Использование

### Запуск сервера

Режим разработки (с авто-перезапуском):
```bash
npm run dev
```

Режим продакшн:
```bash
npm run build
npm start
```

С помощью Docker:
```bash
docker compose up
```

### API Эндпоинты

#### GET /

Проксирует запросы к изображениям от поддерживаемых провайдеров.

Параметры запроса:
- `url` (обязательный): URL изображения для получения
- `width` (опциональный): минимальная ширина изображения, до которой надо увеличить картинку
- `height` (опциональный): минимальная высота изображения, до которой надо увеличить картинку
- `aspect` (опциональный): соотношение сторон, например `4:3` или `16:9`. Если указано, то ширина или высота будут доведены до нужно размера. Если указывать aspect, то width и height тоже нужно обязательно указать.
Для изменения размера изображения нужно обязательно указать оба width и height.

Примеры запросов:
```
# Google Drive
http://localhost:2920/?url=https://drive.google.com/file/d/YOUR_FILE_ID/view

# Яндекс.Диск
http://localhost:2920/?url=https://disk.yandex.ru/d/LuLr3JDmys3nAg/9999A2САМОРЕЗ3.9X25-40 (1500х2000).jpg
# with resizing
https://localhost:2920?url=https://disk.yandex.ru/i/ES1RdRlVkzxiUQ&width=900&height=1200&aspect=4:3

# Прямой URL
http://localhost:2920/?url=https://example.com/image.jpg
```

## Переменные окружения

- `PORT`: Порт сервера (по умолчанию: 2920)

## Разработка

Проект использует TypeScript со строгой типизацией. Исходный код находится в директории `src`, скомпилированный код — в `dist`.

Доступные npm-скрипты:
- `npm run build`: Компиляция TypeScript
- `npm run start`: Запуск сервера в продакшн-режиме
- `npm run dev`: Запуск сервера в режиме разработки с авто-перезапуском

## Поддержка Docker

В проекте реализована поддержка Docker для контейнеризации. Используйте `docker-compose up` для запуска сервиса в контейнере.

## Лицензия

GPL-3.0 License
